(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9e18bf86"],{"229c":function(e,t,a){"use strict";a("e0bd")},"46f3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{attrs:{shadow:"never"}},[t("div",{staticClass:"head-desc",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("跟踪信息")]),t("el-button",{on:{click:e.backPage}},[e._v("返回")])],1),t("el-form",{attrs:{inline:!0,"label-position":"right","label-width":"130px"}},[t("div",{staticClass:"detail-desc"},[t("div",{staticClass:"detail-info"},[t("h3",{staticClass:"tit"},[e._v("基础信息")]),t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"信息是否反馈公安"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.updateVO.isFeedbackPolice,callback:function(t){e.$set(e.updateVO,"isFeedbackPolice",t)},expression:"updateVO.isFeedbackPolice"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"窝点是否捣毁"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.updateVO.denIsDestroyed,callback:function(t){e.$set(e.updateVO,"denIsDestroyed",t)},expression:"updateVO.denIsDestroyed"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"窝点捣毁日期"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.updateVO.denDestroyDate,callback:function(t){e.$set(e.updateVO,"denDestroyDate",t)},expression:"updateVO.denDestroyDate"}})],1)],1)],1)],1)])]),t("div",{staticClass:"up-load"},[t("el-upload",{ref:"upload",staticClass:"model_upload_box",attrs:{drag:"",action:"#","on-change":e.handleChange,"before-upload":e.onChange,"show-file-list":!1,headers:{responseType:"arraybuffer",token:e.token},multiple:"","file-list":e.fileList,limit:10,accept:".XLS,.xls,.XLSX,.xlsx,.zip,.docx,.doc,.pdf,.mp4","on-error":e.errorHandle,"http-request":e.handleRequest}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text",domProps:{innerHTML:e._s("文件大小限制100M")}})]),t("el-progress",{directives:[{name:"show",rawName:"v-show",value:0!==e.progressPercent,expression:"progressPercent !== 0"}],staticClass:"progress",attrs:{"stroke-width":25,"text-inside":!0,percentage:e.progressPercent}})],1),t("div",{staticClass:"follow-tab"},[t("h2",{staticClass:"title"},[e._v("入网视频")]),t("el-table",{staticClass:"tab",staticStyle:{width:"100%"},attrs:{data:e.flieData,"header-cell-style":{background:"rgba(194, 210, 255, 0.3)",color:"#040415"}}},[t("el-table-column",{attrs:{prop:"fileName",label:"文件名称","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"createDate",label:"上传时间","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{label:e.$t("handle"),"header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteFileRow(a.row)}}},[e._v("删除")]),a.row.id?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.downLoadFile(a.row)}}},[e._v("\n                            下载\n                        ")]):e._e()]}}])})],1)],1),t("div",{staticClass:"btn"},[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary"},on:{click:e.edit}},[e._v("确认")]),t("el-button",{on:{click:e.backPage}},[e._v("取消")])],1)],1)],1)},i=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("c5f6"),a("7f7f"),a("a481"),a("ade3")),s=a("ed08"),r=a("dea3");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={data:function(){return{loading:!1,updateVO:{isFeedbackPolice:"",denIsDestroyed:"",denDestroyDate:"",id:""},options:[{label:"是",value:"是"},{label:"否",value:"否"}],fileList:[],url:"".concat(window.SITE_CONFIG["apiURL"],"/workorder/common/file/uploadFile"),token:this.$getUserToken("token"),flieData:[],detailFileList:[],progressPercent:0}},activated:function(){this.getInfo()},created:function(){},methods:{edit:function(){var e=this;this.loading=!0,this.fileList=this.flieData.map((function(t){return c({bussinessId:e.$route.query.id},t)})),this.$http.post("/workorder/woInvolvedPhone/tracking/update",c({fileInfoList:this.fileList},this.updateVO)).then((function(t){if(0!=t.data.code)return e.loading=!1,e.$message.error(t.data.msg);e.loading=!1,e.$message.success("修改成功"),e.backPage()}))},backPage:function(){Object(s["j"])(this.$store.state.contentTabsActiveName)},getInfo:function(){var e=this;this.updateVO=c({},this.$route.query),this.$http.get("/workorder/common/file/getFileList",{params:{bussinessId:this.$route.query.id}}).then((function(t){e.flieData=t.data.data})).catch((function(){}))},handleChange:function(e,t){},onChange:function(e){var t=e.name.replace(/.+\./,""),a=["XLS","xls","XLSX","xlsx","zip","docx","doc","pdf","mp4"];if(-1===a.indexOf(t.toLowerCase()))return this.$message.warning("请上传格式正确的文件"),!1;var n=e.size/1024/1024<100;if(!n)return this.$message.warning("文件大小不能超过100M"),!1;this.fileList=[e]},uploadSuccess:function(e,t,a){this.flieData=[e.data],this.$message.success("上传成功")},handleRequest:function(e){var t=this,a=new FormData;a.append("file",e.file);var n={onUploadProgress:function(e){t.progressPercent=Number((e.loaded/e.total*100).toFixed(2))}};this.$http.post("/workorder/common/file/uploadFile",a,n).then((function(e){t.flieData=[e.data.data],t.progressPercent=0,t.$message.success("上传成功")}))},errorHandle:function(e,t,a){return this.fileList=[],this.flieData=[],this.$message.error("上传失败，请重新上传")},handleExceed:function(e,t,a){this.$message.warning("当前限制选择 10 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},deleteFileRow:function(e){var t=e.id,a=e.fileName;t?this.del(t):(this.flieData=this.flieData.filter((function(e){return e.fileName!=a})),this.fileList=this.fileList.filter((function(e){return e.name!=a})))},del:function(e){var t=this,a=[];a.push(e),this.$confirm("此操作将删除该附件，请确认操作！","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:function(){},beforeClose:function(n,i,o){"confirm"===n?t.$http.post("/workorder/common/file/deleteFile",a).then((function(a){if(0!==a.data.code)return o(),i.confirmButtonLoading=!1,t.$message.error(a.data.msg);i.confirmButtonLoading=!1,o(),t.flieData=t.flieData.filter((function(t){return t.id!=e})),t.$message.success("删除成功")})):o()}}).finally((function(){ctx.confirmButtonLoading=!1})).catch((function(){ctx.confirmButtonLoading=!1}))},downLoadFile:function(e){this.$http({method:"get",withCredentials:!1,timeout:36e4,responseType:"blob",url:"/workorder/common/file/download",params:{fileId:e.id}}).then((function(t){Object(r["a"])(t.data,e.fileName,"")}))}}},u=d,f=(a("229c"),a("2877")),p=Object(f["a"])(u,n,i,!1,null,"6fb96d70",null);t["default"]=p.exports},e0bd:function(e,t,a){}}]);