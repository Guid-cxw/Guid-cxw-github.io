(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ab196f2"],{"3ae5":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"en-US"===e.$i18n.locale?"120px":"80px"}},[t("el-form-item",{attrs:{label:e.$t("notice.type"),prop:"type"}},[t("ren-radio-group",{attrs:{"dict-type":"notice_type"},model:{value:e.dataForm.type,callback:function(t){e.$set(e.dataForm,"type",t)},expression:"dataForm.type"}})],1),t("el-form-item",{attrs:{label:e.$t("notice.title"),prop:"title"}},[t("el-input",{attrs:{placeholder:e.$t("notice.title")},model:{value:e.dataForm.title,callback:function(t){e.$set(e.dataForm,"title",t)},expression:"dataForm.title"}})],1),t("el-form-item",{attrs:{prop:"content",label:e.$t("notice.content")}},[t("div",{staticStyle:{height:"280px"},attrs:{id:"J_quillEditor"}}),t("el-upload",{staticStyle:{display:"none"},attrs:{action:e.uploadUrl,"show-file-list":!1,"before-upload":e.uploadBeforeUploadHandle,"on-success":e.uploadSuccessHandle}},[t("el-button",{ref:"uploadBtn",attrs:{type:"primary",size:"small"}},[e._v(e._s(e.$t("upload.button")))])],1)],1),t("el-form-item",{attrs:{label:e.$t("notice.receiverType"),prop:""}},[t("el-radio-group",{model:{value:e.dataForm.receiverType,callback:function(t){e.$set(e.dataForm,"receiverType",t)},expression:"dataForm.receiverType"}},[t("el-radio",{attrs:{label:0}},[e._v(e._s(e.$t("notice.receiverType0")))]),t("el-radio",{attrs:{label:1}},[e._v(e._s(e.$t("notice.receiverType1")))])],1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.dataForm.receiverType,expression:"dataForm.receiverType == 1"}],attrs:{size:"mini",label:e.$t("notice.selectDept")}},[t("el-tree",{ref:"deptListTree",attrs:{data:e.deptList,props:{label:"name",children:"children"},"node-key":"id",accordion:"","show-checkbox":""}})],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.dataFormSubmitHandle(0)}}},[e._v(e._s(e.$t("notice.draft")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle(1)}}},[e._v(e._s(e.$t("notice.release")))])],1)],2)},a=[],o=(r("8e6e"),r("456d"),r("28a5"),r("ade3")),s=(r("ac6a"),r("5df3"),r("a78e"),r("b047")),n=r.n(s),l=(r("8096"),r("9339")),d=r.n(l);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p={data:function(){return{visible:!1,quillEditor:null,quillEditorToolbarOptions:[["bold","italic","underline","strike"],["image"],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],["clean"]],uploadUrl:"",deptList:[],dataForm:{id:"",type:0,title:"",content:"",receiverType:0,receiverTypeIds:"",receiverTypeList:[],status:"",senderName:"",senderDate:"",creator:"",createDate:""}}},computed:{dataRule:function(){var e=this,t=function(t,r,i){if(e.quillEditor.getLength()<=1)return i(new Error(e.$t("validate.required")));i()};return{type:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],title:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],content:[{required:!0,message:this.$t("validate.required"),trigger:"blur"},{validator:t,trigger:"blur"}],receiverType:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],receiverTypeIds:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],status:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],senderName:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}]}}},methods:{init:function(){var e=this;this.visible=!0,this.$nextTick((function(){e.quillEditor?e.quillEditor.deleteText(0,e.quillEditor.getLength()):e.quillEditorHandle(),e.$refs["dataForm"].resetFields(),Promise.all([e.getDeptList()]).then((function(){e.dataForm.id&&e.getInfo()}))}))},quillEditorHandle:function(){var e=this;this.quillEditor=new d.a("#J_quillEditor",{modules:{toolbar:this.quillEditorToolbarOptions},theme:"snow"}),this.uploadUrl="".concat(window.SITE_CONFIG["apiURL"],"/system/sys/oss/upload?token=").concat(this.$getUserToken("token")),this.quillEditor.getModule("toolbar").addHandler("image",(function(){e.$refs.uploadBtn.$el.click()})),this.quillEditor.on("text-change",(function(){e.dataForm.content=e.quillEditor.root.innerHTML}))},uploadBeforeUploadHandle:function(e){if("image/jpg"!==e.type&&"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/gif"!==e.type)return this.$message.error(this.$t("upload.tip",{format:"jpg、png、gif"})),!1},uploadSuccessHandle:function(e,t,r){if(0!==e.code)return this.$message.error(e.msg);this.quillEditor.insertEmbed(this.quillEditor.getSelection().index,"image",e.data.src)},getDeptList:function(){var e=this;return this.$http.get("/system/sys/dept/list").then((function(t){var r=t.data;if(0!==r.code)return e.$message.error(r.msg);e.deptList=r.data})).catch((function(){}))},getInfo:function(){var e=this;this.$http.get("/system/sys/notice/".concat(this.dataForm.id)).then((function(t){var r=t.data;if(0!==r.code)return e.$message.error(r.msg);e.dataForm=u(u({},e.dataForm),r.data),e.quillEditor.root.innerHTML=e.dataForm.content,1===e.dataForm.receiverType&&e.$refs.deptListTree.setCheckedKeys(r.data.receiverTypeIds.split(","))})).catch((function(){}))},dataFormSubmitHandle:n()((function(e){var t=this;this.$refs["dataForm"].validate((function(r){if(!r)return!1;1===t.dataForm.receiverType?(t.dataForm.receiverTypeIds=t.$refs.deptListTree.getCheckedKeys().join(","),t.dataForm.receiverTypeList=t.$refs.deptListTree.getCheckedKeys()):t.dataForm.receiverTypeIds="",t.dataForm.status=e,t.$http[t.dataForm.id?"put":"post"]("/system/sys/notice/",t.dataForm).then((function(e){var r=e.data;if(0!==r.code)return t.$message.error(r.msg);t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}})})).catch((function(){}))}))}),1e3,{leading:!0,trailing:!1})}},m=p,f=r("2877"),g=Object(f["a"])(m,i,a,!1,null,null,null);t["default"]=g.exports},"5df3":function(e,t,r){"use strict";var i=r("02f4")(!0);r("01f9")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=i(t,r),this._i+=e.length,{value:e,done:!1})}))}}]);