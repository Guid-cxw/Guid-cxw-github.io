(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f1d9dde","chunk-7ab196f2"],{2485:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"aui-card--fill",attrs:{shadow:"never"}},[t("div",{staticClass:"mod-demo__sysnotice"},[t("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getDataList()}}},[t("el-form-item",[t("ren-select",{attrs:{"dict-type":"notice_type",placeholder:e.$t("notice.type")},model:{value:e.dataForm.type,callback:function(t){e.$set(e.dataForm,"type",t)},expression:"dataForm.type"}})],1),t("el-form-item",[t("el-button",{on:{click:function(t){return e.getDataList()}}},[e._v(e._s(e.$t("query")))])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addOrUpdateHandle()}}},[e._v(e._s(e.$t("add")))])],1),t("el-form-item",[t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteHandle()}}},[e._v(e._s(e.$t("deleteBatch")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:""},on:{"selection-change":e.dataListSelectionChangeHandle}},[t("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),t("el-table-column",{attrs:{prop:"title",label:e.$t("notice.title"),"header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"type",label:e.$t("notice.type"),"header-align":"center",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.$getDictLabel("notice_type",t.row.type))+"\n                ")]}}])}),t("el-table-column",{attrs:{prop:"senderName",label:e.$t("notice.senderName"),"header-align":"center",align:"center",width:"150"}}),t("el-table-column",{attrs:{prop:"senderDate",label:e.$t("notice.senderDate"),"header-align":"center",align:"center",width:"170"}}),t("el-table-column",{attrs:{prop:"status",label:e.$t("notice.status"),"header-align":"center",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(r){return[0===r.row.status?t("el-tag",{attrs:{size:"small",type:"danger"}},[e._v("\n                        "+e._s(e.$t("notice.status0"))+"\n                    ")]):t("el-tag",{attrs:{size:"small",type:"success"}},[e._v(e._s(e.$t("notice.status1")))])]}}])}),t("el-table-column",{attrs:{label:e.$t("handle"),fixed:"right","header-align":"center",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(r){return[0===r.row.status?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.addOrUpdateHandle(r.row.id)}}},[e._v("\n                        "+e._s(e.$t("update"))+"\n                    ")]):e._e(),1===r.row.status?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.viewHandle(r.row)}}},[e._v("\n                        "+e._s(e.$t("notice.view"))+"\n                    ")]):e._e(),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteHandle(r.row.id)}}},[e._v("\n                        "+e._s(e.$t("delete"))+"\n                    ")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.pageSizeChangeHandle,"current-change":e.pageCurrentChangeHandle}}),e.addOrUpdateVisible?t("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:e.getDataList}}):e._e()],1)])},i=[],n=(r("7f7f"),r("e1a5")),o=r("3ae5"),l=r("a18c"),s={mixins:[n["a"]],data:function(){return{mixinViewModuleOptions:{getDataListURL:"/system/sys/notice/page",getDataListIsPage:!0,deleteURL:"/system/sys/notice",deleteIsBatch:!0},dataForm:{type:""}}},components:{AddOrUpdate:o["default"]},methods:{viewHandle:function(e){var t={routeName:"".concat(this.$route.name,"__").concat(e.id),title:this.$t("notice.view1"),path:"notice/notice-view",params:{id:e.id}};Object(l["a"])(t,this.$router)}}},d=s,c=r("2877"),u=Object(c["a"])(d,a,i,!1,null,null,null);t["default"]=u.exports},"3ae5":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{visible:e.visible,title:e.dataForm.id?e.$t("update"):e.$t("add"),"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"en-US"===e.$i18n.locale?"120px":"80px"}},[t("el-form-item",{attrs:{label:e.$t("notice.type"),prop:"type"}},[t("ren-radio-group",{attrs:{"dict-type":"notice_type"},model:{value:e.dataForm.type,callback:function(t){e.$set(e.dataForm,"type",t)},expression:"dataForm.type"}})],1),t("el-form-item",{attrs:{label:e.$t("notice.title"),prop:"title"}},[t("el-input",{attrs:{placeholder:e.$t("notice.title")},model:{value:e.dataForm.title,callback:function(t){e.$set(e.dataForm,"title",t)},expression:"dataForm.title"}})],1),t("el-form-item",{attrs:{prop:"content",label:e.$t("notice.content")}},[t("div",{staticStyle:{height:"280px"},attrs:{id:"J_quillEditor"}}),t("el-upload",{staticStyle:{display:"none"},attrs:{action:e.uploadUrl,"show-file-list":!1,"before-upload":e.uploadBeforeUploadHandle,"on-success":e.uploadSuccessHandle}},[t("el-button",{ref:"uploadBtn",attrs:{type:"primary",size:"small"}},[e._v(e._s(e.$t("upload.button")))])],1)],1),t("el-form-item",{attrs:{label:e.$t("notice.receiverType"),prop:""}},[t("el-radio-group",{model:{value:e.dataForm.receiverType,callback:function(t){e.$set(e.dataForm,"receiverType",t)},expression:"dataForm.receiverType"}},[t("el-radio",{attrs:{label:0}},[e._v(e._s(e.$t("notice.receiverType0")))]),t("el-radio",{attrs:{label:1}},[e._v(e._s(e.$t("notice.receiverType1")))])],1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.dataForm.receiverType,expression:"dataForm.receiverType == 1"}],attrs:{size:"mini",label:e.$t("notice.selectDept")}},[t("el-tree",{ref:"deptListTree",attrs:{data:e.deptList,props:{label:"name",children:"children"},"node-key":"id",accordion:"","show-checkbox":""}})],1)],1),t("template",{slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.dataFormSubmitHandle(0)}}},[e._v(e._s(e.$t("notice.draft")))]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmitHandle(1)}}},[e._v(e._s(e.$t("notice.release")))])],1)],2)},i=[],n=(r("8e6e"),r("456d"),r("28a5"),r("ade3")),o=(r("ac6a"),r("5df3"),r("a78e"),r("b047")),l=r.n(o),s=(r("8096"),r("9339")),d=r.n(s);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(n["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p={data:function(){return{visible:!1,quillEditor:null,quillEditorToolbarOptions:[["bold","italic","underline","strike"],["image"],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],["clean"]],uploadUrl:"",deptList:[],dataForm:{id:"",type:0,title:"",content:"",receiverType:0,receiverTypeIds:"",receiverTypeList:[],status:"",senderName:"",senderDate:"",creator:"",createDate:""}}},computed:{dataRule:function(){var e=this,t=function(t,r,a){if(e.quillEditor.getLength()<=1)return a(new Error(e.$t("validate.required")));a()};return{type:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],title:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],content:[{required:!0,message:this.$t("validate.required"),trigger:"blur"},{validator:t,trigger:"blur"}],receiverType:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],receiverTypeIds:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],status:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}],senderName:[{required:!0,message:this.$t("validate.required"),trigger:"blur"}]}}},methods:{init:function(){var e=this;this.visible=!0,this.$nextTick((function(){e.quillEditor?e.quillEditor.deleteText(0,e.quillEditor.getLength()):e.quillEditorHandle(),e.$refs["dataForm"].resetFields(),Promise.all([e.getDeptList()]).then((function(){e.dataForm.id&&e.getInfo()}))}))},quillEditorHandle:function(){var e=this;this.quillEditor=new d.a("#J_quillEditor",{modules:{toolbar:this.quillEditorToolbarOptions},theme:"snow"}),this.uploadUrl="".concat(window.SITE_CONFIG["apiURL"],"/system/sys/oss/upload?token=").concat(this.$getUserToken("token")),this.quillEditor.getModule("toolbar").addHandler("image",(function(){e.$refs.uploadBtn.$el.click()})),this.quillEditor.on("text-change",(function(){e.dataForm.content=e.quillEditor.root.innerHTML}))},uploadBeforeUploadHandle:function(e){if("image/jpg"!==e.type&&"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/gif"!==e.type)return this.$message.error(this.$t("upload.tip",{format:"jpg、png、gif"})),!1},uploadSuccessHandle:function(e,t,r){if(0!==e.code)return this.$message.error(e.msg);this.quillEditor.insertEmbed(this.quillEditor.getSelection().index,"image",e.data.src)},getDeptList:function(){var e=this;return this.$http.get("/system/sys/dept/list").then((function(t){var r=t.data;if(0!==r.code)return e.$message.error(r.msg);e.deptList=r.data})).catch((function(){}))},getInfo:function(){var e=this;this.$http.get("/system/sys/notice/".concat(this.dataForm.id)).then((function(t){var r=t.data;if(0!==r.code)return e.$message.error(r.msg);e.dataForm=u(u({},e.dataForm),r.data),e.quillEditor.root.innerHTML=e.dataForm.content,1===e.dataForm.receiverType&&e.$refs.deptListTree.setCheckedKeys(r.data.receiverTypeIds.split(","))})).catch((function(){}))},dataFormSubmitHandle:l()((function(e){var t=this;this.$refs["dataForm"].validate((function(r){if(!r)return!1;1===t.dataForm.receiverType?(t.dataForm.receiverTypeIds=t.$refs.deptListTree.getCheckedKeys().join(","),t.dataForm.receiverTypeList=t.$refs.deptListTree.getCheckedKeys()):t.dataForm.receiverTypeIds="",t.dataForm.status=e,t.$http[t.dataForm.id?"put":"post"]("/system/sys/notice/",t.dataForm).then((function(e){var r=e.data;if(0!==r.code)return t.$message.error(r.msg);t.$message({message:t.$t("prompt.success"),type:"success",duration:500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}})})).catch((function(){}))}))}),1e3,{leading:!0,trailing:!1})}},m=p,g=r("2877"),f=Object(g["a"])(m,a,i,!1,null,null,null);t["default"]=f.exports},"5df3":function(e,t,r){"use strict";var a=r("02f4")(!0);r("01f9")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=a(t,r),this._i+=e.length,{value:e,done:!1})}))}}]);